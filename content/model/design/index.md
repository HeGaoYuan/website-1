---
title: "Workflow"
description: "Workflow"
lead: ""
date: 2020-11-12T15:22:20+01:00
lastmod: 2020-11-12T15:22:20+01:00
draft: false
images: []
menu:
  model:
    parent: "intro"
weight: 200
toc: true
---
This diagram illustrates the workflow from model generation to model deployment.

{{< img src="design.png" alt="design" caption="Workflow" >}}


- A ModelVersion CRD can be generated by a user manually or programmatically by a training job. KubeDL training jobs (Tensorflow and Pytorch)
already integrates this. Check the CRD spec for [Tensorflow Job](https://github.com/alibaba/kubedl/blob/master/apis/training/v1alpha1/tfjob_types.go#L53) and [Pytorch Job.](https://github.com/alibaba/kubedl/blob/master/apis/training/v1alpha1/pytorchjob_types.go#L46)

- The ModelVersion Controller watches the ModelVersion CRD and does the following steps:
    1. Create a Model CRD, if not exists, and associate it with the corresponding ModelVersion CRDs. The Model CRD serves as the parent for grouping the underneath ModelVersions
    2. Create the PV and PVC for the backend model storage where the actual model artifacts are exported by the training job or manually specified by the user.
    3. Create a Kaniko pod mounted with previous PVC for the model. The Kaniko pod generates a docker image that incorporates the model artifacts and push to the dockerhub. The model artifacts will be preset at a pre-defined location `/kubedl-model` inside the container.
